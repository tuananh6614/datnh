<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sơ đồ Hệ thống Bãi đỗ xe Thông minh</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #fff;
            padding: 30px;
            min-height: 100vh;
        }

        .page {
            max-width: 1400px;
            margin: 0 auto;
            background: #fff;
            padding: 30px;
        }

        .main-title {
            text-align: center;
            color: #0066cc;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .sub-title {
            text-align: center;
            color: #333;
            font-size: 18px;
            margin-bottom: 30px;
        }

        /* ===== PHẦN 1: CHUẨN GIAO TIẾP ===== */
        .section-title {
            background: linear-gradient(135deg, #0066cc, #0099ff);
            color: white;
            padding: 12px 25px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 8px;
            margin: 30px 0 20px 0;
            display: inline-block;
        }

        .protocols-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .protocol-card {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }

        .protocol-card:hover {
            border-color: #0066cc;
            box-shadow: 0 4px 15px rgba(0,102,204,0.2);
        }

        .protocol-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 15px;
        }

        .protocol-name {
            font-size: 16px;
            font-weight: bold;
            color: #0066cc;
            margin-bottom: 8px;
        }

        .protocol-desc {
            font-size: 12px;
            color: #666;
            line-height: 1.5;
        }

        /* ===== PHẦN 2: SƠ ĐỒ 4 LỚP ===== */
        .layers-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
        }

        .layers-diagram {
            flex: 1;
            max-width: 450px;
        }

        .layer-box {
            border: 3px solid #4a90d9;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            background: linear-gradient(180deg, #e8f4fc 0%, #d0e8f7 100%);
            position: relative;
        }

        .layer-number {
            position: absolute;
            left: -20px;
            top: 50%;
            transform: translateY(-50%);
            background: #0066cc;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
        }

        .layer-title {
            text-align: center;
            font-weight: bold;
            color: #0066cc;
            font-size: 16px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px dashed #4a90d9;
        }

        .layer-items {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
        }

        .layer-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 70px;
        }

        .item-icon {
            width: 50px;
            height: 50px;
            margin-bottom: 5px;
        }

        .item-label {
            font-size: 9px;
            text-align: center;
            color: #333;
            line-height: 1.2;
        }

        /* Arrow between layers */
        .layer-arrow {
            text-align: center;
            margin: -5px 0;
            color: #4a90d9;
            font-size: 24px;
        }

        /* ===== PHẦN 3: SƠ ĐỒ TỔNG QUAN ===== */
        .overview-diagram {
            flex: 1.5;
            background: #fafafa;
            border: 2px solid #ddd;
            border-radius: 15px;
            padding: 25px;
            position: relative;
        }

        .overview-title {
            background: #0066cc;
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 25px;
        }

        .overview-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .overview-node {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .node-icon {
            width: 80px;
            height: 80px;
            margin-bottom: 10px;
        }

        .node-label {
            font-size: 13px;
            font-weight: bold;
            color: #333;
        }

        .connection-line {
            display: flex;
            align-items: center;
            color: #666;
            font-size: 11px;
        }

        .arrow-line {
            width: 60px;
            height: 2px;
            background: #999;
            position: relative;
        }

        .arrow-line::after {
            content: '';
            position: absolute;
            right: 0;
            top: -4px;
            border: 5px solid transparent;
            border-left-color: #999;
        }

        .bidirectional {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3px;
        }

        .protocol-label {
            background: #fff;
            border: 1px solid #ccc;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            color: #0066cc;
            font-weight: bold;
        }

        /* ===== CHI TIẾT CÁC LỚP ===== */
        .layer-details {
            margin-top: 40px;
        }

        .detail-section {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .detail-header {
            background: linear-gradient(135deg, #0066cc, #0099ff);
            color: white;
            padding: 15px 20px;
            font-weight: bold;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-header .layer-num {
            background: white;
            color: #0066cc;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .detail-content {
            padding: 20px;
        }

        .detail-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #eee;
        }

        .detail-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .detail-icon {
            width: 60px;
            height: 60px;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .detail-info h4 {
            color: #0066cc;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .detail-info p {
            color: #666;
            font-size: 13px;
            line-height: 1.5;
        }

        /* Print styles */
        @media print {
            body {
                padding: 10px;
            }
            .page {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="page">
        <h1 class="main-title">HE THONG BAI DO XE THONG MINH</h1>
        <p class="sub-title">Smart Parking System - Kien truc 4 lop IoT</p>

        <!-- PHẦN 1: CHUẨN GIAO TIẾP -->
        <div class="section-title">1. Cac chuan giao tiep su dung trong du an</div>

        <div class="protocols-grid">
            <!-- MQTT -->
            <div class="protocol-card">
                <svg class="protocol-icon" viewBox="0 0 100 100">
                    <rect x="10" y="30" width="80" height="40" rx="5" fill="#660099" stroke="#440066" stroke-width="2"/>
                    <text x="50" y="55" text-anchor="middle" fill="white" font-size="14" font-weight="bold">MQTT</text>
                    <circle cx="25" cy="20" r="8" fill="#ff6600"/>
                    <circle cx="50" cy="15" r="8" fill="#00cc66"/>
                    <circle cx="75" cy="20" r="8" fill="#0099ff"/>
                    <line x1="25" y1="28" x2="30" y2="30" stroke="#ff6600" stroke-width="2"/>
                    <line x1="50" y1="23" x2="50" y2="30" stroke="#00cc66" stroke-width="2"/>
                    <line x1="75" y1="28" x2="70" y2="30" stroke="#0099ff" stroke-width="2"/>
                    <circle cx="25" cy="80" r="8" fill="#ff6600"/>
                    <circle cx="75" cy="80" r="8" fill="#0099ff"/>
                    <line x1="25" y1="72" x2="30" y2="70" stroke="#ff6600" stroke-width="2"/>
                    <line x1="75" y1="72" x2="70" y2="70" stroke="#0099ff" stroke-width="2"/>
                </svg>
                <div class="protocol-name">MQTT Protocol</div>
                <div class="protocol-desc">Message Queuing Telemetry Transport<br>Publish/Subscribe - QoS 0,1,2<br>Port: 1883</div>
            </div>

            <!-- HTTP/REST API -->
            <div class="protocol-card">
                <svg class="protocol-icon" viewBox="0 0 100 100">
                    <rect x="15" y="25" width="70" height="50" rx="8" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                    <text x="50" y="45" text-anchor="middle" fill="white" font-size="11" font-weight="bold">HTTP</text>
                    <text x="50" y="60" text-anchor="middle" fill="white" font-size="9">REST API</text>
                    <path d="M30 15 L50 5 L70 15" stroke="#2E7D32" stroke-width="3" fill="none"/>
                    <path d="M30 85 L50 95 L70 85" stroke="#2E7D32" stroke-width="3" fill="none"/>
                    <circle cx="50" cy="5" r="4" fill="#4CAF50"/>
                    <circle cx="50" cy="95" r="4" fill="#4CAF50"/>
                </svg>
                <div class="protocol-name">HTTP/REST API</div>
                <div class="protocol-desc">RESTful Web Services<br>JSON Data Format<br>GET, POST, PUT, DELETE</div>
            </div>

            <!-- PostgreSQL -->
            <div class="protocol-card">
                <svg class="protocol-icon" viewBox="0 0 100 100">
                    <ellipse cx="50" cy="25" rx="35" ry="12" fill="#336791" stroke="#1d4f6f" stroke-width="2"/>
                    <path d="M15 25 L15 70 Q15 82 50 82 Q85 82 85 70 L85 25" fill="#336791" stroke="#1d4f6f" stroke-width="2"/>
                    <ellipse cx="50" cy="70" rx="35" ry="12" fill="#4a7ba7" stroke="#1d4f6f" stroke-width="2"/>
                    <line x1="20" y1="40" x2="80" y2="40" stroke="#1d4f6f" stroke-width="1" stroke-dasharray="3"/>
                    <line x1="20" y1="55" x2="80" y2="55" stroke="#1d4f6f" stroke-width="1" stroke-dasharray="3"/>
                    <text x="50" y="50" text-anchor="middle" fill="white" font-size="9" font-weight="bold">PostgreSQL</text>
                </svg>
                <div class="protocol-name">PostgreSQL Protocol</div>
                <div class="protocol-desc">Wire Protocol v3.0<br>TCP/IP Connection<br>Port: 5432</div>
            </div>

            <!-- WiFi/SPI -->
            <div class="protocol-card">
                <svg class="protocol-icon" viewBox="0 0 100 100">
                    <path d="M50 85 L50 85" stroke="#0066cc" stroke-width="8" stroke-linecap="round"/>
                    <path d="M30 70 Q50 55 70 70" stroke="#0066cc" stroke-width="4" fill="none"/>
                    <path d="M20 55 Q50 35 80 55" stroke="#0066cc" stroke-width="4" fill="none"/>
                    <path d="M10 40 Q50 15 90 40" stroke="#0066cc" stroke-width="4" fill="none"/>
                    <circle cx="50" cy="85" r="6" fill="#0066cc"/>
                </svg>
                <div class="protocol-name">WiFi + SPI</div>
                <div class="protocol-desc">IEEE 802.11 b/g/n<br>SPI Bus (RFID, TFT)<br>2.4GHz Band</div>
            </div>
        </div>

        <!-- PHẦN 2: SƠ ĐỒ 4 LỚP VÀ TỔNG QUAN -->
        <div class="section-title">2. Kien truc 4 lop IoT</div>

        <div class="layers-container">
            <!-- SƠ ĐỒ 4 LỚP BÊN TRÁI -->
            <div class="layers-diagram">
                <!-- Lớp 4: Ứng dụng -->
                <div class="layer-box">
                    <div class="layer-number">4</div>
                    <div class="layer-title">Lop Ung dung (Application Layer)</div>
                    <div class="layer-items">
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="5" y="5" width="40" height="30" rx="2" fill="#333" stroke="#222" stroke-width="2"/>
                                <rect x="8" y="8" width="34" height="24" fill="#4a90d9"/>
                                <rect x="15" y="38" width="20" height="3" fill="#555"/>
                                <rect x="10" y="41" width="30" height="4" rx="1" fill="#444"/>
                            </svg>
                            <span class="item-label">Desktop App</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="10" y="2" width="30" height="46" rx="4" fill="#333" stroke="#222" stroke-width="2"/>
                                <rect x="13" y="6" width="24" height="34" fill="#4a90d9"/>
                                <circle cx="25" cy="44" r="2" fill="#555"/>
                            </svg>
                         
                        </div>
                    </div>
                </div>

                <div class="layer-arrow">▼</div>

                <!-- Lớp 3: Xử lý -->
                <div class="layer-box">
                    <div class="layer-number">3</div>
                    <div class="layer-title">Lop Xu ly (Processing Layer)</div>
                    <div class="layer-items">
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="5" y="10" width="40" height="30" rx="3" fill="#2d2d2d" stroke="#1a1a1a" stroke-width="2"/>
                                <rect x="8" y="15" width="8" height="3" fill="#00ff00"/>
                                <rect x="8" y="20" width="8" height="3" fill="#00ff00"/>
                                <rect x="8" y="25" width="8" height="3" fill="#ffcc00"/>
                                <rect x="20" y="15" width="22" height="20" fill="#1a1a1a"/>
                                <line x1="22" y1="18" x2="40" y2="18" stroke="#00ff00" stroke-width="1"/>
                                <line x1="22" y1="22" x2="38" y2="22" stroke="#00ff00" stroke-width="1"/>
                                <line x1="22" y1="26" x2="35" y2="26" stroke="#00ff00" stroke-width="1"/>
                            </svg>
                            <span class="item-label">Linux Server</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <ellipse cx="25" cy="15" rx="18" ry="8" fill="#336791" stroke="#1d4f6f" stroke-width="2"/>
                                <path d="M7 15 L7 35 Q7 43 25 43 Q43 43 43 35 L43 15" fill="#336791" stroke="#1d4f6f" stroke-width="2"/>
                                <ellipse cx="25" cy="35" rx="18" ry="8" fill="#4a7ba7"/>
                            </svg>
                            <span class="item-label">PostgreSQL</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="10" y="15" width="30" height="25" rx="3" fill="#660099"/>
                                <text x="25" y="32" text-anchor="middle" fill="white" font-size="8" font-weight="bold">MQTT</text>
                                <circle cx="15" cy="10" r="4" fill="#ff6600"/>
                                <circle cx="35" cy="10" r="4" fill="#00cc66"/>
                                <line x1="15" y1="14" x2="18" y2="15" stroke="#ff6600" stroke-width="2"/>
                                <line x1="35" y1="14" x2="32" y2="15" stroke="#00cc66" stroke-width="2"/>
                            </svg>
                            <span class="item-label">MQTT Broker</span>
                        </div>
                    </div>
                </div>

                <div class="layer-arrow">▼</div>

                <!-- Lớp 2: Mạng -->
                <div class="layer-box">
                    <div class="layer-number">2</div>
                    <div class="layer-title">Lop Mang (Network Layer)</div>
                    <div class="layer-items">
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="10" y="20" width="30" height="20" rx="2" fill="#1565C0" stroke="#0D47A1" stroke-width="2"/>
                                <circle cx="15" cy="25" r="2" fill="#4CAF50"/>
                                <circle cx="21" cy="25" r="2" fill="#4CAF50"/>
                                <rect x="14" y="30" width="22" height="2" fill="#333"/>
                                <rect x="14" y="34" width="22" height="2" fill="#333"/>
                                <path d="M25 5 L25 5" stroke="#1565C0" stroke-width="4" stroke-linecap="round"/>
                                <path d="M15 12 Q25 5 35 12" stroke="#1565C0" stroke-width="2" fill="none"/>
                                <path d="M10 17 Q25 8 40 17" stroke="#1565C0" stroke-width="2" fill="none"/>
                            </svg>
                            <span class="item-label">WiFi Router</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="5" y="15" width="40" height="25" rx="3" fill="#37474F" stroke="#263238" stroke-width="2"/>
                                <rect x="10" y="20" width="6" height="4" fill="#4CAF50"/>
                                <rect x="18" y="20" width="6" height="4" fill="#FFC107"/>
                                <rect x="26" y="20" width="6" height="4" fill="#4CAF50"/>
                                <rect x="34" y="20" width="6" height="4" fill="#4CAF50"/>
                                <rect x="10" y="28" width="30" height="8" fill="#263238"/>
                                <text x="25" y="35" text-anchor="middle" fill="#4CAF50" font-size="6">SWITCH</text>
                            </svg>
                            <span class="item-label">Switch</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <circle cx="25" cy="25" r="20" fill="none" stroke="#2196F3" stroke-width="2" stroke-dasharray="5,3"/>
                                <circle cx="25" cy="25" r="12" fill="none" stroke="#2196F3" stroke-width="2"/>
                                <circle cx="25" cy="25" r="4" fill="#2196F3"/>
                                <circle cx="25" cy="8" r="3" fill="#4CAF50"/>
                                <circle cx="40" cy="30" r="3" fill="#FF9800"/>
                                <circle cx="10" cy="30" r="3" fill="#9C27B0"/>
                            </svg>
                            <span class="item-label">LAN Network</span>
                        </div>
                    </div>
                </div>

                <div class="layer-arrow">▼</div>

                <!-- Lớp 1: Thiết bị -->
                <div class="layer-box">
                    <div class="layer-number">1</div>
                    <div class="layer-title">Lop Thiet bi (Perception Layer)</div>
                    <div class="layer-items">
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="8" y="10" width="34" height="25" rx="3" fill="#1B5E20" stroke="#0D3610" stroke-width="2"/>
                                <rect x="12" y="14" width="10" height="8" fill="#333"/>
                                <rect x="25" y="14" width="14" height="4" fill="#FFD700"/>
                                <rect x="25" y="20" width="14" height="4" fill="#C0C0C0"/>
                                <circle cx="14" cy="30" r="2" fill="#4CAF50"/>
                                <circle cx="20" cy="30" r="2" fill="#2196F3"/>
                                <rect x="5" y="38" width="8" height="6" fill="#666"/>
                                <rect x="37" y="38" width="8" height="6" fill="#666"/>
                            </svg>
                            <span class="item-label">ESP32-S3</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="10" y="10" width="30" height="30" rx="3" fill="#2196F3" stroke="#1565C0" stroke-width="2"/>
                                <circle cx="25" cy="25" r="12" fill="none" stroke="#FFC107" stroke-width="3"/>
                                <circle cx="25" cy="25" r="6" fill="#FFC107"/>
                                <rect x="5" y="22" width="5" height="6" fill="#666"/>
                                <rect x="40" y="22" width="5" height="6" fill="#666"/>
                            </svg>
                            <span class="item-label">RFID RC522</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="8" y="8" width="34" height="28" rx="2" fill="#222" stroke="#111" stroke-width="2"/>
                                <rect x="10" y="10" width="30" height="24" fill="#000080"/>
                                <text x="25" y="20" text-anchor="middle" fill="#00FF00" font-size="6">TFT LCD</text>
                                <text x="25" y="28" text-anchor="middle" fill="#FFFF00" font-size="5">ST7735</text>
                                <rect x="15" y="38" width="20" height="4" fill="#666"/>
                            </svg>
                            <span class="item-label">TFT ST7735</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="12" y="8" width="26" height="20" rx="3" fill="#333" stroke="#222" stroke-width="2"/>
                                <circle cx="25" cy="18" r="8" fill="#1a1a1a" stroke="#444" stroke-width="2"/>
                                <circle cx="25" cy="18" r="4" fill="#2196F3"/>
                                <rect x="18" y="30" width="14" height="15" fill="#555"/>
                                <rect x="15" y="32" width="20" height="3" fill="#666"/>
                            </svg>
                            <span class="item-label">Camera HD</span>
                        </div>
                        <div class="layer-item">
                            <svg class="item-icon" viewBox="0 0 50 50">
                                <rect x="5" y="5" width="40" height="30" rx="2" fill="#333" stroke="#222" stroke-width="2"/>
                                <rect x="8" y="8" width="34" height="24" fill="#1a1a1a"/>
                                <rect x="10" y="10" width="30" height="20" fill="#2d5a8c"/>
                                <rect x="15" y="38" width="20" height="3" fill="#555"/>
                                <rect x="5" y="41" width="40" height="5" rx="1" fill="#444"/>
                                <rect x="10" y="43" width="4" height="2" fill="#333"/>
                                <rect x="16" y="43" width="4" height="2" fill="#333"/>
                            </svg>
                            <span class="item-label">Desktop PC</span>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 15px; padding: 10px; background: #e8f4fc; border-radius: 8px;">
                    <strong style="color: #0066cc;">IoT Layers Architecture</strong>
                </div>
            </div>

            <!-- SƠ ĐỒ TỔNG QUAN BÊN PHẢI -->
            <div class="overview-diagram">
                <div class="overview-title">Tong quan He thong</div>

                <svg width="100%" height="400" viewBox="0 0 600 400">
                    <!-- End User -->
                    <g transform="translate(300, 30)">
                        <circle cx="0" cy="15" r="12" fill="#333"/>
                        <path d="M-15 45 L0 30 L15 45 L10 45 L10 65 L-10 65 L-10 45 Z" fill="#333"/>
                        <text x="0" y="85" text-anchor="middle" font-size="12" font-weight="bold">End User</text>
                    </g>

                    <!-- Lines from End User -->
                    <line x1="270" y1="70" x2="150" y2="150" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <line x1="330" y1="70" x2="450" y2="150" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <text x="190" y="100" font-size="9" fill="#666" transform="rotate(-35 190 100)">Manipulating</text>
                    <text x="380" y="100" font-size="9" fill="#666" transform="rotate(35 380 100)">User Interface</text>

                    <!-- Device (ESP32) -->
                    <g transform="translate(80, 180)">
                        <rect x="0" y="0" width="100" height="60" rx="5" fill="#1B5E20" stroke="#0D3610" stroke-width="2"/>
                        <rect x="10" y="10" width="30" height="20" fill="#333"/>
                        <rect x="50" y="10" width="40" height="10" fill="#FFD700"/>
                        <rect x="50" y="25" width="40" height="10" fill="#C0C0C0"/>
                        <circle cx="20" cy="45" r="5" fill="#4CAF50"/>
                        <circle cx="35" cy="45" r="5" fill="#2196F3"/>
                        <text x="50" y="75" text-anchor="middle" font-size="12" font-weight="bold">Device</text>
                        <text x="50" y="88" text-anchor="middle" font-size="9" fill="#666">(ESP32-S3)</text>
                    </g>

                    <!-- MQTT Broker -->
                    <g transform="translate(250, 180)">
                        <rect x="0" y="0" width="100" height="60" rx="5" fill="#660099" stroke="#440066" stroke-width="2"/>
                        <text x="50" y="25" text-anchor="middle" fill="white" font-size="16" font-weight="bold">MQTT</text>
                        <text x="50" y="45" text-anchor="middle" fill="white" font-size="10">Broker</text>
                        <text x="50" y="75" text-anchor="middle" font-size="12" font-weight="bold">MQTT Broker</text>
                    </g>

                    <!-- Server Backend -->
                    <g transform="translate(420, 150)">
                        <rect x="0" y="0" width="100" height="70" rx="5" fill="#37474F" stroke="#263238" stroke-width="2"/>
                        <rect x="10" y="10" width="80" height="15" fill="#263238"/>
                        <text x="50" y="22" text-anchor="middle" fill="#4CAF50" font-size="8">Linux Server</text>
                        <rect x="10" y="30" width="35" height="30" fill="#336791"/>
                        <text x="27" y="50" text-anchor="middle" fill="white" font-size="7">DB</text>
                        <rect x="50" y="30" width="40" height="30" fill="#4CAF50"/>
                        <text x="70" y="50" text-anchor="middle" fill="white" font-size="7">API</text>
                        <text x="50" y="90" text-anchor="middle" font-size="12" font-weight="bold">Server - Backend</text>
                    </g>

                    <!-- Mobile/Web App -->

                    <!-- Connection arrows and labels -->
                    <!-- Device to MQTT -->
                    <line x1="180" y1="210" x2="250" y2="210" stroke="#666" stroke-width="2"/>
                    <polygon points="248,206 258,210 248,214" fill="#666"/>
                    <rect x="195" y="195" width="40" height="15" fill="white" stroke="#ccc" rx="3"/>
                    <text x="215" y="206" text-anchor="middle" font-size="9" fill="#660099" font-weight="bold">MQTT</text>

                    <!-- MQTT to Server -->
                    <line x1="350" y1="210" x2="420" y2="195" stroke="#666" stroke-width="2"/>
                    <polygon points="418,191 428,193 420,200" fill="#666"/>
                    <rect x="365" y="188" width="40" height="15" fill="white" stroke="#ccc" rx="3"/>
                    <text x="385" y="199" text-anchor="middle" font-size="9" fill="#660099" font-weight="bold">MQTT</text>

                    <!-- Server to Web App -->
                    <line x1="520" y1="200" x2="520" y2="180" stroke="#666" stroke-width="2"/>
                    <polygon points="516,182 520,172 524,182" fill="#666"/>
                    <text x="545" y="190" font-size="8" fill="#666">APIs/</text>
                    <text x="545" y="200" font-size="8" fill="#666">REST</text>

                    <!-- YOLOv8 / ALPR Box -->
                    <g transform="translate(250, 300)">
                        <rect x="0" y="0" width="100" height="50" rx="5" fill="#FF5722" stroke="#E64A19" stroke-width="2"/>
                        <text x="50" y="20" text-anchor="middle" fill="white" font-size="11" font-weight="bold">YOLOv8</text>
                        <text x="50" y="35" text-anchor="middle" fill="white" font-size="9">ALPR + EasyOCR</text>
                        <text x="50" y="65" text-anchor="middle" font-size="10" font-weight="bold">AI Processing</text>
                    </g>

                    <!-- Desktop App -->
                    <g transform="translate(80, 300)">
                        <rect x="0" y="0" width="80" height="50" rx="3" fill="#333" stroke="#222" stroke-width="2"/>
                        <rect x="5" y="5" width="70" height="35" fill="#2d5a8c"/>
                        <text x="40" y="27" text-anchor="middle" fill="white" font-size="8">PySide6</text>
                        <rect x="25" y="52" width="30" height="3" fill="#555"/>
                        <text x="40" y="70" text-anchor="middle" font-size="10" font-weight="bold">Desktop App</text>
                    </g>

                    <!-- Connection: Desktop to ALPR -->
                    <line x1="160" y1="325" x2="250" y2="325" stroke="#666" stroke-width="2"/>
                    <polygon points="248,321 258,325 248,329" fill="#666"/>
                    <text x="205" y="318" font-size="8" fill="#666">Camera Feed</text>

                    <!-- Connection: ALPR to Server -->
                    <line x1="350" y1="320" x2="420" y2="250" stroke="#666" stroke-width="2"/>
                    <polygon points="418,246 428,250 420,258" fill="#666"/>
                    <text x="400" y="275" font-size="8" fill="#666">Plate Data</text>

                    <!-- Connection: Desktop to Server (direct) -->
                    <path d="M160 310 Q200 280 420 220" stroke="#666" stroke-width="1" fill="none" stroke-dasharray="5,3"/>
                    <text x="280" y="260" font-size="8" fill="#999">PostgreSQL</text>

                    <!-- Arrow marker definition -->
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>

        <!-- PHẦN 3: CHI TIẾT CÁC LỚP -->
        <div class="layer-details">
            <div class="section-title">3. Chi tiet cac lop</div>

            <!-- Lớp 1: Thiết bị ngoại vi -->
            <div class="detail-section">
                <div class="detail-header">
                    <span class="layer-num">1</span>
                    Lớp thiết bị ngoại (Perception Layer)
                </div>
                <div class="detail-content">
                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="8" y="10" width="44" height="32" rx="4" fill="#1B5E20" stroke="#0D3610" stroke-width="2"/>
                            <rect x="14" y="16" width="14" height="10" fill="#333"/>
                            <rect x="32" y="16" width="16" height="6" fill="#FFD700"/>
                            <rect x="32" y="24" width="16" height="6" fill="#C0C0C0"/>
                            <circle cx="18" cy="36" r="3" fill="#4CAF50"/>
                            <circle cx="28" cy="36" r="3" fill="#2196F3"/>
                            <rect x="5" y="45" width="12" height="8" fill="#666"/>
                            <rect x="43" y="45" width="12" height="8" fill="#666"/>
                        </svg>
                        <div class="detail-info">
                            <h4>ESP32-S3 (x2)</h4>
                            <p><strong>ESP32-S3 #1:</strong> Quan ly cong vao/ra, doc RFID, gui du lieu thoi gian thuc qua MQTT toi server.<br>
                            <strong>ESP32-S3 #2:</strong> Xu ly thanh toan, ket noi may chu (HTTP/REST API) hoac WebSocket, hien thi thong tin len TFT.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="10" y="10" width="40" height="40" rx="4" fill="#2196F3" stroke="#1565C0" stroke-width="2"/>
                            <circle cx="30" cy="30" r="15" fill="none" stroke="#FFC107" stroke-width="4"/>
                            <circle cx="30" cy="30" r="8" fill="#FFC107"/>
                            <rect x="2" y="25" width="8" height="10" fill="#666"/>
                            <rect x="50" y="25" width="8" height="10" fill="#666"/>
                        </svg>
                        <div class="detail-info">
                            <h4>RFID Reader RC522 (x3)</h4>
                            <p>Doc, ghi thong tin vao the. Su dung giao tiep SPI. Tan so 13.56MHz, ho tro the MIFARE.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="8" y="8" width="44" height="36" rx="3" fill="#222" stroke="#111" stroke-width="2"/>
                            <rect x="11" y="11" width="38" height="30" fill="#000080"/>
                            <text x="30" y="25" text-anchor="middle" fill="#00FF00" font-size="8">TFT LCD</text>
                            <text x="30" y="35" text-anchor="middle" fill="#FFFF00" font-size="6">128x160 RGB</text>
                            <rect x="18" y="48" width="24" height="6" fill="#666"/>
                        </svg>
                        <div class="detail-info">
                            <h4>TFT Display ST7735</h4>
                            <p>Hien thi thong tin duoc ghi boi the, trang thai thanh toan. Do phan giai 128x160 pixel, 16-bit mau RGB.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="14" y="8" width="32" height="26" rx="4" fill="#333" stroke="#222" stroke-width="2"/>
                            <circle cx="30" cy="21" r="10" fill="#1a1a1a" stroke="#444" stroke-width="2"/>
                            <circle cx="30" cy="21" r="5" fill="#2196F3"/>
                            <circle cx="30" cy="21" r="2" fill="#1a1a1a"/>
                            <rect x="22" y="36" width="16" height="18" fill="#555"/>
                            <rect x="18" y="40" width="24" height="4" fill="#666"/>
                        </svg>
                        <div class="detail-info">
                            <h4>Camera HD (x2)</h4>
                            <p>Chup bien so (ALPR input), 1 cho cong vao, 1 cho cong ra. Do phan giai toi thieu 720p, ho tro USB/IP Camera.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="5" y="5" width="50" height="38" rx="3" fill="#333" stroke="#222" stroke-width="2"/>
                            <rect x="8" y="8" width="44" height="32" fill="#1a1a1a"/>
                            <rect x="10" y="10" width="40" height="28" fill="#2d5a8c"/>
                            <rect x="18" y="46" width="24" height="4" fill="#555"/>
                            <rect x="5" y="50" width="50" height="6" rx="2" fill="#444"/>
                            <rect x="10" y="52" width="6" height="3" fill="#333"/>
                            <rect x="18" y="52" width="6" height="3" fill="#333"/>
                        </svg>
                        <div class="detail-info">
                            <h4>Desktop/Laptop</h4>
                            <p>Cau hinh toi thieu: Intel i5-8400 / AMD R5-2600, 8GB DDR4 2400MHz, SSD 128GB + HDD 256GB, Windows 10/11 64-bit.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lớp 2: Kết nối và giao thức -->
            <div class="detail-section">
                <div class="detail-header">
                    <span class="layer-num">2</span>
                    Lop Ket noi va Giao thuc (Network Layer)
                </div>
                <div class="detail-content">
                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="8" y="20" width="44" height="28" rx="4" fill="#660099" stroke="#440066" stroke-width="2"/>
                            <text x="30" y="38" text-anchor="middle" fill="white" font-size="12" font-weight="bold">MQTT</text>
                            <circle cx="15" cy="12" r="6" fill="#ff6600"/>
                            <circle cx="30" cy="8" r="6" fill="#00cc66"/>
                            <circle cx="45" cy="12" r="6" fill="#0099ff"/>
                            <line x1="15" y1="18" x2="20" y2="20" stroke="#ff6600" stroke-width="2"/>
                            <line x1="30" y1="14" x2="30" y2="20" stroke="#00cc66" stroke-width="2"/>
                            <line x1="45" y1="18" x2="40" y2="20" stroke="#0099ff" stroke-width="2"/>
                        </svg>
                        <div class="detail-info">
                            <h4>MQTT (Message Queuing Telemetry Transport)</h4>
                            <p>Giao thuc truyen du lieu thoi gian thuc giua thiet bi va may chu (publish/subscribe). Lightweight, phu hop IoT. Port: 1883.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <circle cx="30" cy="55" r="5" fill="#0066cc"/>
                            <path d="M15 45 Q30 35 45 45" stroke="#0066cc" stroke-width="3" fill="none"/>
                            <path d="M8 35 Q30 20 52 35" stroke="#0066cc" stroke-width="3" fill="none"/>
                            <path d="M2 25 Q30 5 58 25" stroke="#0066cc" stroke-width="3" fill="none"/>
                        </svg>
                        <div class="detail-info">
                            <h4>WiFi (IEEE 802.11 b/g/n)</h4>
                            <p>Ket noi khong day 2.4GHz, toc do len den 150Mbps. Ket noi ESP32 va cac thiet bi voi mang LAN.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <ellipse cx="30" cy="18" rx="22" ry="10" fill="#336791" stroke="#1d4f6f" stroke-width="2"/>
                            <path d="M8 18 L8 42 Q8 52 30 52 Q52 52 52 42 L52 18" fill="#336791" stroke="#1d4f6f" stroke-width="2"/>
                            <ellipse cx="30" cy="42" rx="22" ry="10" fill="#4a7ba7" stroke="#1d4f6f" stroke-width="2"/>
                            <line x1="12" y1="28" x2="48" y2="28" stroke="#1d4f6f" stroke-width="1" stroke-dasharray="3"/>
                        </svg>
                        <div class="detail-info">
                            <h4>PostgreSQL Wire Protocol</h4>
                            <p>Giao thuc giao tiep truc tiep giua ung dung va co so du lieu PostgreSQL. TCP/IP, Port: 5432.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="10" y="15" width="40" height="35" rx="5" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                            <text x="30" y="32" text-anchor="middle" fill="white" font-size="10" font-weight="bold">HTTP</text>
                            <text x="30" y="44" text-anchor="middle" fill="white" font-size="8">REST</text>
                            <path d="M20 8 L30 2 L40 8" stroke="#2E7D32" stroke-width="2" fill="none"/>
                            <circle cx="30" cy="2" r="3" fill="#4CAF50"/>
                        </svg>
                        <div class="detail-info">
                            <h4>HTTP/REST API</h4>
                            <p>Giao thuc ung dung cho phep trao doi du lieu dinh dang JSON giua server - web/app. Methods: GET, POST, PUT, DELETE.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lớp 3: Nền tảng và dữ liệu -->
            <div class="detail-section">
                <div class="detail-header">
                    <span class="layer-num">3</span>
                    Lop Nen tang va Du lieu (Processing Layer)
                </div>
                <div class="detail-content">
                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <ellipse cx="30" cy="15" rx="24" ry="10" fill="#336791" stroke="#1d4f6f" stroke-width="2"/>
                            <path d="M6 15 L6 45 Q6 55 30 55 Q54 55 54 45 L54 15" fill="#336791" stroke="#1d4f6f" stroke-width="2"/>
                            <ellipse cx="30" cy="45" rx="24" ry="10" fill="#4a7ba7" stroke="#1d4f6f" stroke-width="2"/>
                            <line x1="10" y1="28" x2="50" y2="28" stroke="#1d4f6f" stroke-width="1"/>
                            <line x1="10" y1="38" x2="50" y2="38" stroke="#1d4f6f" stroke-width="1"/>
                        </svg>
                        <div class="detail-info">
                            <h4>PostgreSQL Database</h4>
                            <p>Luu tru du lieu xe ra/vao, ve dien tu, nguoi dung, thanh toan. Ho tro ACID, JSON, full-text search.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="5" y="10" width="50" height="35" rx="3" fill="#FF5722" stroke="#E64A19" stroke-width="2"/>
                            <text x="30" y="25" text-anchor="middle" fill="white" font-size="9" font-weight="bold">YOLOv8</text>
                            <text x="30" y="38" text-anchor="middle" fill="white" font-size="7">ALPR Model</text>
                            <rect x="15" y="48" width="30" height="8" rx="2" fill="#E64A19"/>
                            <text x="30" y="55" text-anchor="middle" fill="white" font-size="6">Trained</text>
                        </svg>
                        <div class="detail-info">
                            <h4>ALPR - YOLOv8 (Pre-trained)</h4>
                            <p>Mo hinh nhan dien bien so, xac dinh vung bien. Trained tren dataset bien so Viet Nam. Inference time < 50ms.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="5" y="15" width="50" height="30" rx="3" fill="#9C27B0" stroke="#7B1FA2" stroke-width="2"/>
                            <text x="30" y="28" text-anchor="middle" fill="white" font-size="8" font-weight="bold">EasyOCR</text>
                            <text x="30" y="40" text-anchor="middle" fill="white" font-size="14">ABC</text>
                        </svg>
                        <div class="detail-info">
                            <h4>EasyOCR</h4>
                            <p>Nhan dang ky tu tu anh bien so. Ho tro 80+ ngon ngu, bao gom tieng Viet. GPU acceleration.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="5" y="10" width="50" height="40" rx="3" fill="#2196F3" stroke="#1565C0" stroke-width="2"/>
                            <text x="30" y="28" text-anchor="middle" fill="white" font-size="8" font-weight="bold">OpenCV</text>
                            <circle cx="20" cy="40" r="6" fill="none" stroke="white" stroke-width="2"/>
                            <circle cx="40" cy="40" r="6" fill="none" stroke="white" stroke-width="2"/>
                            <line x1="26" y1="40" x2="34" y2="40" stroke="white" stroke-width="2"/>
                        </svg>
                        <div class="detail-info">
                            <h4>OpenCV (cv2)</h4>
                            <p>Xu ly anh, trich khung hinh tu camera. Image preprocessing, filtering, edge detection.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="5" y="10" width="50" height="40" rx="4" fill="#2d2d2d" stroke="#1a1a1a" stroke-width="2"/>
                            <rect x="10" y="16" width="10" height="4" fill="#00ff00"/>
                            <rect x="10" y="22" width="10" height="4" fill="#00ff00"/>
                            <rect x="10" y="28" width="10" height="4" fill="#ffcc00"/>
                            <rect x="25" y="16" width="25" height="28" fill="#1a1a1a"/>
                            <text x="37" y="28" text-anchor="middle" fill="#00ff00" font-size="5">$ sudo</text>
                            <text x="37" y="36" text-anchor="middle" fill="#00ff00" font-size="5">systemctl</text>
                        </svg>
                        <div class="detail-info">
                            <h4>Linux Server (Ubuntu)</h4>
                            <p>Trien khai MQTT Broker (Mosquitto), Web API (Flask/Gunicorn), Database (PostgreSQL). 24/7 uptime.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lớp 4: Ứng dụng -->
            <div class="detail-section">
                <div class="detail-header">
                    <span class="layer-num">4</span>
                    Lop Ung dung (Application Layer)
                </div>
                <div class="detail-content">
                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="5" y="5" width="50" height="38" rx="3" fill="#333" stroke="#222" stroke-width="2"/>
                            <rect x="8" y="8" width="44" height="32" fill="#2d5a8c"/>
                            <rect x="12" y="12" width="20" height="12" fill="#4a90d9"/>
                            <rect x="35" y="12" width="14" height="24" fill="#3d7ab8"/>
                            <rect x="12" y="26" width="20" height="10" fill="#1a4a6e"/>
                            <rect x="18" y="46" width="24" height="4" fill="#555"/>
                            <rect x="5" y="50" width="50" height="6" rx="2" fill="#444"/>
                        </svg>
                        <div class="detail-info">
                            <h4>Desktop App (PySide6)</h4>
                            <p>Ung dung dieu khien va giam sat bai do xe, luu tru anh chup. Giao dien Qt6, da luong, ket noi MQTT client.</p>
                        </div>
                    </div>

                    <div class="detail-item">
                        <svg class="detail-icon" viewBox="0 0 60 60">
                            <rect x="5" y="5" width="50" height="50" rx="5" fill="#fff" stroke="#ddd" stroke-width="2"/>
                            <rect x="8" y="8" width="44" height="10" fill="#0066cc"/>
                            <rect x="10" y="10" width="8" height="6" fill="#fff"/>
                            <rect x="20" y="10" width="8" height="6" fill="#fff"/>
                            <rect x="30" y="10" width="8" height="6" fill="#fff"/>
                            <rect x="10" y="22" width="18" height="28" fill="#e0e0e0"/>
                            <rect x="32" y="22" width="18" height="12" fill="#4CAF50"/>
                            <rect x="32" y="38" width="18" height="12" fill="#2196F3"/>
                        </svg>
                        <div class="detail-info">
                            <h4>Web App (Flask)</h4>
                            <p>Quan ly toan bo he thong. Dashboard, bao cao, quan ly the, nhan vien. Responsive design, REST API backend.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 40px; padding: 20px; background: #f5f5f5; border-radius: 10px;">
            <p style="color: #666; font-size: 12px;">Smart Parking System - Do an Tot nghiep</p>
            <p style="color: #999; font-size: 11px;">Kien truc 4 lop IoT | MQTT + REST API + PostgreSQL</p>
        </div>
    </div>
</body>
</html>
